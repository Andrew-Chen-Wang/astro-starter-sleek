---
import i18next, { changeLanguage } from "i18next";
import { type CollectionEntry, getCollection } from "astro:content";
import BlogItem from "@layouts/BlogItem.astro";

changeLanguage("en");

// Generate a new path for every collection post
export async function getStaticPaths() {
	changeLanguage('en');
    const blogEntries = await getCollection("blog");
    var localizedBlogEntries = blogEntries.filter((entry) => entry.slug.startsWith(i18next.language));
    return localizedBlogEntries.map((post) => {
        let slug: string = post.slug;
        slug = slug.substring(3).replaceAll("blog/", "");
        return {
            params: { slug: slug },
            props: { post: post },
        };
    });
}
type Props = CollectionEntry<"blog">;
// Get the post directly from the prop on render
const { post, lang }: any = Astro.props;
const { data, render } = post;
const { Content } = await render();
---

<BlogItem {...post.data}>
	<Content />
</BlogItem>
